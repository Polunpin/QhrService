<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tencent.dao.StatusLogsMapper">

    <resultMap id="StatusLogsMap" type="com.tencent.model.StatusLog">
        <constructor>
            <idArg column="id" javaType="java.lang.Long" name="id"/>
            <arg column="order_id" javaType="java.lang.Long" name="orderId"/>
            <arg column="operator_type" javaType="java.lang.String" name="operatorType"/>
            <arg column="operator_id" javaType="java.lang.Long" name="operatorId"/>
            <arg column="pre_stage" javaType="java.lang.String" name="preStage"/>
            <arg column="post_stage" javaType="java.lang.String" name="postStage"/>
            <arg column="remark" javaType="java.lang.String" name="remark"/>
            <arg column="created_at" javaType="java.time.LocalDateTime" name="createdAt"/>
        </constructor>
    </resultMap>

    <sql id="StatusLog_Columns">
        id, order_id, operator_type, operator_id, pre_stage, post_stage, remark, created_at
    </sql>

    <select id="getById" resultMap="StatusLogsMap" parameterType="java.lang.Long">
        SELECT <include refid="StatusLog_Columns"/>
        FROM f_status_logs
        WHERE id = #{id}
    </select>

    <select id="listByOrderId" resultMap="StatusLogsMap">
        SELECT <include refid="StatusLog_Columns"/>
        FROM f_status_logs
        WHERE order_id = #{orderId}
        ORDER BY id DESC
        <if test="offset != null and size != null">
            LIMIT #{offset}, #{size}
        </if>
    </select>

    <select id="countByOrderId">
        SELECT COUNT(1)
        FROM f_status_logs
        WHERE order_id = #{orderId}
    </select>

    <insert id="insert" parameterType="com.tencent.model.StatusLog">
        INSERT INTO f_status_logs (order_id, operator_type, operator_id, pre_stage, post_stage, remark)
        VALUES (#{orderId}, #{operatorType}, #{operatorId}, #{preStage}, #{postStage}, #{remark})
    </insert>

    <select id="lastInsertId" resultType="long">
        SELECT LAST_INSERT_ID()
    </select>

</mapper>
